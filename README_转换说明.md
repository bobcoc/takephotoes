# Excel文件转换说明

## 概述
此程序将原始的2025.xlsx学生名册文件转换为适合tvds.py学生录像系统使用的mt2025.xlsx格式。

## 文件说明

### 原始文件格式 (2025.xlsx)
- **列结构**: 序号、班级、录取编号、考号、新生姓名、性别、备注
- **数据**: 332名学生，分布在7个班级
- **问题**: 格式不符合tvds.py的要求

### 转换后文件格式 (mt2025.xlsx)
- **列结构**: 考号、姓名（仅保留必要的两列）
- **工作表**: 按班级分组，每个班级一个工作表
- **兼容性**: 完全兼容tvds.py的load_students_info函数

## 转换结果

### 班级分布
| 班级 | 学生数量 |
|------|----------|
| 班级1 | 49名学生 |
| 班级2 | 48名学生 |
| 班级3 | 49名学生 |
| 班级4 | 47名学生 |
| 班级5 | 44名学生 |
| 班级6 | 48名学生 |
| 班级7 | 47名学生 |
| **总计** | **332名学生** |

### 数据格式示例
```
考号        姓名
202510101   蔡妡乐
202510102   曾炯豪
202510103   陈烁轩
...
```

## 使用方法

### 1. 执行转换
```bash
python convert_excel.py
```

### 2. 验证转换结果
```bash
python test_compatibility.py
```

### 3. 在tvds.py中使用
转换后的文件已经自动配置到tvds.py中：
```python
excel_path = "mt2025.xlsx"  # 使用转换后的文件
```

## 功能特点

1. **自动班级分组**: 根据原始文件中的班级列自动创建工作表
2. **数据清洗**: 自动过滤无效数据和表头行
3. **格式标准化**: 确保输出格式完全符合tvds.py要求
4. **错误处理**: 完善的异常处理和数据验证
5. **兼容性测试**: 包含完整的兼容性验证功能

## 文件清单

- `convert_excel.py` - 主转换程序
- `test_compatibility.py` - 兼容性测试程序
- `2025.xlsx` - 原始学生名册文件
- `mt2025.xlsx` - 转换后的文件（供tvds.py使用）
- `tvds.py` - 学生录像系统（已配置使用新文件）

## 注意事项

1. 确保2025.xlsx文件存在于同一目录下
2. 转换程序会自动覆盖现有的mt2025.xlsx文件
3. tvds.py已经配置为使用新的文件路径
4. 每个班级都有独立的工作表，可在tvds.py界面中选择

## 技术实现

转换程序使用以下技术：
- **openpyxl**: Excel文件读写
- **数据验证**: 确保考号和姓名不为空
- **错误处理**: 完善的异常捕获机制
- **格式化输出**: 友好的用户界面和进度提示

转换完成后，mt2025.xlsx文件可以直接在tvds.py学生录像系统中使用，支持按班级选择学生进行录像。